


 <%- include('../includes/userHeader') %>  
 <style media="screen">
    figure.zoom {
  background-position: 50% 50%;
  position: relative;
  /* margin: 150px auto;
  border: 5px solid white;
  box-shadow: -1px 5px 15px black; */
  /* height: 300px; */
  /* width: 500px; */
  overflow: hidden;
  cursor: zoom-in;
}
figure.zoom img:hover {
  opacity: 0;
}
figure.zoom img {
  transition: opacity 0.5s;
  display: block;
  width: 100%;
}
  </style>
 


<div class="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col">
                <p class="bread"><span><a href="/">Home</a></span> / <span>Product Details</span></p>
            </div>
        </div>
    </div>
</div>


<div class="colorlib-product">
    <div class="container">
        <div class="row row-pb-lg product-detail-wrap">
            <div class="col-sm-8">
                <div class="owl-carousel">
                    <div class="item" >
                        <div class="product-entry border">
                            <a href="#" class="prod-img">
                                <figure   class="zoom" onmousemove="zoom(event)" style="background-image: url(/images/<%=product.imageUrl[0]%>)">
                                <img id="imageZoom" src="/images/<%= product.imageUrl[0] %> " class="img-fluid  " alt="Free html5 bootstrap 4 template">
                            </figure>
                           
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="product-entry border">
                            <a href="#" class="prod-img" >
                                <figure   class="zoom" onmousemove="zoom(event)" style="background-image: url(/images/<%=product.imageUrl[1]%>)">
                                <img src="/images/<%= product.imageUrl[1]%> " class="img-fluid" alt="Free html5 bootstrap 4 template">
                            </figure>
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="product-entry border">
                            <a href="#" class="prod-img">
                                <figure   class="zoom" onmousemove="zoom(event)" style="background-image: url(/images/<%=product.imageUrl[2]%>)">
                                <img src="/images/<%= product.imageUrl[2]%> " class="img-fluid " alt="Free html5 bootstrap 4 template">
                            </figure>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="product-desc">
                    <h3><%= product.name  %></h3>
                    <p class="font-weight-bold"><%= product.brand %> </p>
                    <p class="price"> 
                        <% if ( product.discountPrice==0) { %>
                            <span class="price">₹<%= product.price%> </span>
                             <% } else { %>
                                <span class="price"><del>₹<%= product.price%></del> </span>
                                <span class="price">₹<%= product.discountPrice%> </span>
                                <% } %>
                        <% if (product.stock==0) { %>
                         
                            <p class="font-weight-b" >Availability : <span  style="color: red;">Product not available </span> </p>
                            <% } else { %>
                                
                                <p >Availability : <span class="font-weight-bold"><%= product.stock %> </span>More </p>
                                <% } %>
                             <span class="rate">
                            <% for( let s = 0; s <(product.rating/product.review)/20 ; s++ ) { %>
                                <i class="icon-star-full"></i>
                            <% } %>
                            (<%= product.rating %> Rating)
                        </span>
                    </p>
                    <p><%= product.description %> </p>
              <div class="row">
               <% if (user) { %>
                
                <div class="col-sm-12 text-center">
                      <button id="btn" class="addtocart  btn btn-primary btn-addtocart" >
                          <i class="icon-shopping-cart"></i> Add to Cart
                      </button>
                      </div>

                  </div>
                   <% } else { %>
                 
                    <div class="col-sm-12 text-center">
                          <a href="/login"  class="addtocart  btn btn-primary btn-addtocart" >
                              <i class="icon-shopping-cart"></i> Add to Cart
                            </a>
                          </div>
               <% } %>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12">
                <div class="row">
                    <div class="col-md-12 pills">
                        <div class="bd-example bd-example-tabs">
                          <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">

                            <li class="nav-item">
                              <a class="nav-link active" id="pills-description-tab" data-toggle="pill" href="#pills-description" role="tab" aria-controls="pills-description" aria-expanded="true">Description</a>
                            </li>
                           
                            <li class="nav-item">
                              <a class="nav-link" id="pills-review-tab" data-toggle="pill" href="#pills-review" role="tab" aria-controls="pills-review" aria-expanded="true">Review</a>
                            </li>
                          </ul>

                          <div class="tab-content" id="pills-tabContent">
                            <div class="tab-pane border fade show active" id="pills-description" role="tabpanel" aria-labelledby="pills-description-tab">
                              <p><%= product.description %>.</p>
                            
                            </div>
                        
                                 <!-- review section -->
                            <div class="tab-pane border fade" id="pills-review" role="tabpanel" aria-labelledby="pills-review-tab">
                              <div class="row">
                                   <div class="col-md-8">
                                       <h3 class="head"><%= review.length %>  Reviews</h3>
                                       <% for( let i = 0; i < review.length; i++ ) { %>
                                       <div class="review">
                                           <div class="user-img" style="background-image: url(images/person1.jpg)"></div>
                                           <div class="desc">
                                               <h4>
                                                   <span class="text-left"><%= review[i].user.name %></span>
                                                   <span class="text-right"><%= review[i].date %></span>
                                               </h4>
                                               <p class="star">
                                                   <span>
                                                    <% for( let l = 0; l < review[i].rating/20; l++ ) { %>
                                                    
                                                        <i class="icon-star-full"></i>
                                                    <% } %>
                                                     
                                                   </span>
                                                   <span class="text-right"><a href="#" class="reply"><i class="icon-reply"></i></a></span>
                                               </p>
                                               <p><%= review[i].review %></p>
                                           </div>
                                       </div>
                                       <% } %>
                                   </div>
                                   <div class="col-md-4">
                                       <div class="rating-wrap">
                                           <h3 class="head">Give a Review</h3>
                                           <div class="wrap">
                                               <p class="star">
                                                   <span>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       (98%)
                                                   </span>
                                                   <span>20 Reviews</span>
                                               </p>
                                               <p class="star">
                                                   <span>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-empty"></i>
                                                       (85%)
                                                   </span>
                                                   <span>10 Reviews</span>
                                               </p>
                                               <p class="star">
                                                   <span>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-empty"></i>
                                                       <i class="icon-star-empty"></i>
                                                       (70%)
                                                   </span>
                                                   <span>5 Reviews</span>
                                               </p>
                                               <p class="star">
                                                   <span>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-empty"></i>
                                                       <i class="icon-star-empty"></i>
                                                       <i class="icon-star-empty"></i>
                                                       (10%)
                                                   </span>
                                                   <span>0 Reviews</span>
                                               </p>
                                               <p class="star">
                                                   <span>
                                                       <i class="icon-star-full"></i>
                                                       <i class="icon-star-empty"></i>
                                                       <i class="icon-star-empty"></i>
                                                       <i class="icon-star-empty"></i>
                                                       <i class="icon-star-empty"></i>
                                                       (0%)
                                                   </span>
                                                   <span>0 Reviews</span>
                                               </p>
                                           </div>
                                       </div>
                                   </div>
                               </div>
                            </div>
                          </div>
                        </div>
                 </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

   
  
    const addToCart = document.querySelector('#btn')
    addToCart.onclick = ()=>{
          console.log("cart");
        axios.post('/cart/<%= product._id %>').then((e)=>{
            if(e.data.noAvailability){

const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000,
  timerProgressBar: true,
  didOpen: (toast) => {
    toast.addEventListener('mouseenter', Swal.stopTimer)
    toast.addEventListener('mouseleave', Swal.resumeTimer)
  }
})

Toast.fire({
  icon: 'error',
  title: 'product is out of stock',
})

            }else if(e.data.stockReached){

                const Toast = Swal.mixin({
  toast: true,
  position: 'top-end',
  showConfirmButton: false,
  timer: 3000,
  timerProgressBar: true,
  didOpen: (toast) => {
    toast.addEventListener('mouseenter', Swal.stopTimer)
    toast.addEventListener('mouseleave', Swal.resumeTimer)
  }
})

Toast.fire({
  icon: 'error',
  title: 'stock  all ready reached',
})
            }else{

            
            Swal.fire({
  position: 'top-end',
  icon: 'success',
  title: 'Your product has been added to the cart',
  showConfirmButton: false,
  timer: 1500
})
}
        })
       
  
}
</script>

<script type="text/javascript">
    function zoom(e){
      var zoomer = e.currentTarget;
      e.offsetX ? offsetX = e.offsetX : offsetX = e.touches[0].pageX
      e.offsetY ? offsetY = e.offsetY : offsetX = e.touches[0].pageX
      x = offsetX/zoomer.offsetWidth*100
      y = offsetY/zoomer.offsetHeight*100
      zoomer.style.backgroundPosition = x + '% ' + y + '%';
    }
    </script>



<%- include('../includes/userFooter') %>  


 
  
  